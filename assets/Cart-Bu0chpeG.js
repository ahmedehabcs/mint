import{R as t,L as b,o as P,k as q,u as O,r as f}from"./index-Py7kvHa0.js";import{a as h}from"./products-DZsIXrs4.js";import{s as g}from"./toastHelper-Cmf0APRO.js";import{B as N}from"./Button-V8RViXZE.js";import{C as Q}from"./CartItem-CHA7lBGK.js";import"./StockIndicator-Bg18On1j.js";import"./CardInformations-BRbc6VdB.js";const R=()=>t.createElement("div",{className:"mb-8"},t.createElement(b,{to:"/",className:"flex items-center space-x-2 text-[var(--color-white)] hover:text-[var(--color-main)] transition-colors px-4 py-2 rounded-lg"},t.createElement(P,{size:20}),t.createElement("span",{className:"font-medium"},"Continue Shopping"))),F=()=>t.createElement("main",{className:"min-h-screen py-8"},t.createElement("div",{className:"container mx-auto px-4"},t.createElement("section",{className:"text-center py-16"},t.createElement("div",{className:"w-24 h-24 bg-[var(--color-hover)] rounded-full flex items-center justify-center mx-auto mb-6"},t.createElement(q,{size:48,className:"text-[var(--color-main)]"})),t.createElement("h2",{className:"text-3xl font-bold text-[var(--color-text)] mb-4"},"Your cart is empty"),t.createElement("p",{className:"text-[var(--color-text-light)] text-lg mb-8"},"Add some products to get started!"),t.createElement(b,{to:"/"},t.createElement(N,{className:"bg-[var(--color-main)] hover:bg-[var(--color-main-dark)] text-[var(--color-white)] px-8 py-3 rounded-lg font-semibold text-lg transition-colors"},"Start Shopping"))))),T=({cartItems:n,onUpdateQuantity:m,onRemoveItem:c,setNoteMessage:i,updatingQuantity:E})=>t.createElement("div",{className:"lg:col-span-2"},t.createElement("div",{className:"space-y-4"},n.map((s,v)=>t.createElement(Q,{key:`${s.productId}-${s.color}-${s.size}`,item:s,index:v,onUpdateQuantity:m,onRemoveItem:c,isUpdating:E===v})))),U=({calculateSubtotal:n,onProceedToCheckout:m})=>t.createElement("div",{className:"lg:col-span-1"},t.createElement("div",{className:"rounded-xl shadow-lg p-6 border border-[var(--color-border)] sticky top-4"},t.createElement("h2",{className:"text-xl font-bold text-[var(--color-text)] mb-6 pb-3 border-b border-[var(--color-border)]"},"Order Summary"),t.createElement("div",{className:"space-y-4 mb-6"},t.createElement("div",{className:"pt-4"},t.createElement("div",{className:"flex justify-between text-lg font-bold"},t.createElement("span",{className:"text-[var(--color-text)]"},"Subtotal"),t.createElement("span",{className:"text-[var(--color-main)]"},n().toFixed(2)," EGP")))),t.createElement(N,{onClick:m,className:"w-full bg-[var(--color-main)] hover:bg-[var(--color-main-dark)] text-[var(--color-background)] py-3 rounded-lg font-semibold text-lg transition-colors"},"Proceed to Checkout"))),A=({setNoteMessage:n})=>{const m=O(),[c,i]=f.useState([]),[E,s]=f.useState(null);f.useEffect(()=>{const a=localStorage.getItem("cart");if(a){const e=JSON.parse(a);if(e.filter(r=>!r.variantId).length>0){localStorage.removeItem("cart"),i([]),g(n,"Your cart has been updated. Please re-add items to continue.",!1);return}i(e),v(e)}},[]);const v=async a=>{try{const e=await Promise.all(a.map(async o=>{try{const r=await h(o.productId),d=r.data.variants?.find(u=>u._id===o.variantId),l=d?d.stock:0;return{...o,stock:l,totalStock:r.data.stock}}catch{return o}}));i(e),localStorage.setItem("cart",JSON.stringify(e))}catch{}};f.useEffect(()=>{localStorage.setItem("cart",JSON.stringify(c))},[c]);const k=async(a,e)=>{const o=c[a];if(o){s(a);try{const[r]=await Promise.all([h(o.productId)]),d=r.data.variants?.find(u=>u._id===o.variantId),l=d?d.stock:0;i(u=>u.map((p,w)=>{if(w===a){const y=p.quantity+e;return y<1?{...p,quantity:1}:y>l?(g(n,`Maximum ${l} items available in stock`,!1),{...p,quantity:l,stock:l}):{...p,quantity:y,stock:l}}return p}))}catch(r){console.error("Error updating quantity:",r),g(n,"Failed to update quantity. Please try again.",!1)}finally{s(null)}}},S=a=>{i(e=>e.filter((o,r)=>r!==a)),window.dispatchEvent(new CustomEvent("cartUpdated")),g(n,"Item removed from cart",!1)},x=()=>c.reduce((a,e)=>a+e.price*e.quantity,0),C=()=>{const a=x(),e=a>50?0:10;return a+e},I=()=>{m("/checkout")};return c.length===0?t.createElement(F,null):t.createElement("div",{className:"min-h-screen py-8"},t.createElement("div",{className:"container mx-auto px-4"},t.createElement(R,null),t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8"},t.createElement(T,{cartItems:c,onUpdateQuantity:k,onRemoveItem:S,setNoteMessage:n,updatingQuantity:E}),t.createElement(U,{cartItems:c,calculateSubtotal:x,calculateTotal:C,onProceedToCheckout:I}))))};export{A as default};
