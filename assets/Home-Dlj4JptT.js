import{r as f,R as e,L as F,F as S,a as C,b as z,u as j,c as k,d as L,e as A,f as O}from"./index-Py7kvHa0.js";import{S as R}from"./StockIndicator-Bg18On1j.js";import{A as T}from"./index-BK19r6JJ.js";import{i as U}from"./isofferActive-Bz0sscgL.js";import{v as M,a as V,s as G,b as y}from"./inputSanitizer-B2bR0dzU.js";import{g as I}from"./products-DZsIXrs4.js";import{s as $}from"./toastHelper-Cmf0APRO.js";const q=({product:b})=>{const[l,m]=f.useState({}),{_id:c,name:g,images:r=[],category:n,gender:i,description:a,price:d,offer:t,offerStartDate:x,offerEndDate:o,variants:u,stock:N}=b,w=u?u.reduce((h,E)=>h+(E.stock||0),0):N||0,s=U(d,t,x,o),p=s?t:d,v=s?Math.round((d-t)/d*100):null;return e.createElement(F,{to:`/product/${c}`,className:"block"},e.createElement("article",{className:"group relative rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 ease-out transform hover:scale-[1.02] border border-[var(--color-border)]"},e.createElement("div",{className:"relative aspect-square overflow-hidden bg-gradient-to-br from-[var(--color-surface)] to-[var(--color-border)]"},r.length>0&&e.createElement("div",{className:"relative w-full h-full"},e.createElement("img",{src:r[0],alt:g,loading:"lazy",onLoad:()=>m(h=>({...h,0:!0})),className:"w-full h-full object-cover transition-transform duration-700 ease-out group-hover:scale-105"}),!l[0]&&e.createElement("div",{className:"absolute inset-0 flex items-center justify-center bg-[var(--color-surface)]"},e.createElement(T,{className:"animate-spin text-3xl text-[var(--color-main)]"})),v&&e.createElement("span",{className:"absolute top-3 left-3 inline-flex items-center px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-bold bg-[var(--color-error)] text-[var(--color-background)] shadow-md"},"-",v,"%"))),e.createElement("section",{className:"p-4 sm:p-5"},e.createElement("div",{className:"mb-3"},e.createElement("div",{className:"flex items-center space-x-2 mb-2"},n&&e.createElement("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-semibold bg-[var(--color-main)]/10 text-[var(--color-main)] border border-[var(--color-main)]/20 hover:bg-[var(--color-main)]/20 transition-colors duration-200"},n),i&&e.createElement("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-semibold bg-[var(--color-secondary)]/10 text-[var(--color-white)] border border-[var(--color-secondary)]/20 hover:bg-[var(--color-secondary)]/20 transition-colors duration-200 capitalize"},i)),e.createElement("div",{className:"flex items-center"},e.createElement(R,{stock:w,quantity:0,size:"small"}))),e.createElement("h3",{className:"text-sm sm:text-base lg:text-lg font-bold text-[var(--color-text)] leading-tight mb-2 line-clamp-2 group-hover:text-[var(--color-main)] transition-colors duration-200"},g),e.createElement("p",{className:"text-xs sm:text-sm text-[var(--color-text-light)] mb-3 line-clamp-2 leading-relaxed"},a),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex flex-col"},e.createElement("div",{className:"flex items-center space-x-2 leading-none"},e.createElement("span",{className:"font-bold text-2xl sm:text-3xl text-[var(--color-stock-high)]"},p),e.createElement("span",{className:"text-sm sm:text-lg font-normal text-[var(--color-stock-high)]"},"EGP"),v&&e.createElement("div",{className:"flex items-center space-x-1 text-xs sm:text-sm text-[var(--color-error)] line-through"},e.createElement("span",null,d),e.createElement("span",null,"EGP"))))))))},P=({categories:b=[],onFilterChange:l,currentFilters:m={},isModal:c=!1,onClose:g=()=>{}})=>{const[r,n]=f.useState(m);f.useEffect(()=>{n(m)},[m]);const i=t=>{const x=t.target.value,o=M(x);if(o.isValid||x===""){const u={...r,search:o.sanitizedValue};n(u),l(u)}},a=(t,x)=>{let o=x;t==="minPrice"||t==="maxPrice"?o=V(x).sanitizedValue:(t==="search"||t==="category"||t==="gender")&&(o=G(x));const u={...r,[t]:o};n(u),l(u)},d=()=>{const t={category:"all",gender:"all",minPrice:"",maxPrice:"",search:""};n(t),l(t),c&&g()};return e.createElement("aside",{className:"bg-[var(--color-background)] rounded-xl shadow-lg p-6 lg:p-8 lg:bg-transparent lg:shadow-none transition-transform duration-300 ease-in-out"},e.createElement("header",{className:"flex items-center justify-between mb-6 pb-4 border-b border-[var(--color-border)]"},e.createElement("h3",{className:"text-xl lg:text-2xl font-bold text-[var(--color-text)]"},"Filters"),c&&e.createElement("button",{onClick:g,className:"p-2 text-[var(--color-text-light)] hover:text-[var(--color-text)] rounded-full transition-colors"},e.createElement(S,{size:20}))),e.createElement("section",{className:"space-y-6"},e.createElement("section",null,e.createElement("label",{className:"block text-sm lg:text-base font-semibold text-[var(--color-text)] mb-2"},"Search"),e.createElement("div",{className:"relative"},e.createElement(C,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-[var(--color-text-light)]"}),e.createElement("input",{type:"text",value:r.search||"",onChange:i,placeholder:"Search products...",className:"w-full pl-10 pr-4 py-3 border border-[var(--color-border)] rounded-full focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] focus:border-transparent transition-colors text-sm text-[var(--color-text)] placeholder:text-[var(--color-text-light)]"}))),e.createElement("section",null,e.createElement("label",{className:"block text-sm lg:text-base font-semibold text-[var(--color-text)] mb-2"},"Category"),e.createElement("select",{value:r.category,onChange:t=>a("category",t.target.value),className:"w-full px-4 py-3 border border-[var(--color-border)] rounded-full focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] focus:border-transparent transition-colors text-sm appearance-none bg-[var(--color-background)] text-[var(--color-text)] bg-[url('data:image/svg+xml;charset=UTF-8,%3csvg xmlns=\\'http://www.w3.org/2000/svg\\' viewBox=\\'0 0 24 24\\' fill=\\'none\\' stroke=\\'currentColor\\' stroke-width=\\'2\\' stroke-linecap=\\'round\\' stroke-linejoin=\\'round\\'%3e%3cpath d=\\'M6 9l6 6 6-6\\'%3e%3c/path%3e%3c/svg%3e')] bg-right bg-no-repeat pr-10"},e.createElement("option",{value:"all"},"All Categories"),b.map(t=>e.createElement("option",{key:t,value:t},t.charAt(0).toUpperCase()+t.slice(1))))),e.createElement("section",null,e.createElement("label",{className:"block text-sm lg:text-base font-semibold text-[var(--color-text)] mb-2"},"Gender"),e.createElement("div",{className:"flex flex-wrap gap-2"},["all","male","female","unisex"].map(t=>e.createElement("button",{key:t,onClick:()=>a("gender",t),className:`
                    px-4 py-2 rounded-full transition-colors duration-200 text-sm font-medium capitalize
                    ${r.gender===t?"bg-[var(--color-main)] text-[var(--color-background)] shadow-md":"bg-[var(--color-surface)] text-[var(--color-text-light)] hover:bg-[var(--color-hover)] hover:text-[var(--color-text)]"}
                `},t)))),e.createElement("section",null,e.createElement("label",{className:"block text-sm lg:text-base font-semibold text-[var(--color-text)] mb-2"},"Price Range (EGP)"),e.createElement("div",{className:"flex items-center gap-3"},e.createElement("input",{type:"number",value:r.minPrice||"",onChange:t=>a("minPrice",t.target.value),placeholder:"Min",className:"w-full px-3 py-2 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] focus:border-transparent transition-colors text-sm text-[var(--color-text)] placeholder:text-[var(--color-text-light)]"}),e.createElement("span",{className:"text-[var(--color-text-light)]"},"-"),e.createElement("input",{type:"number",value:r.maxPrice||"",onChange:t=>a("maxPrice",t.target.value),placeholder:"Max",className:"w-full px-3 py-2 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] focus:border-transparent transition-colors text-sm text-[var(--color-text)] placeholder:text-[var(--color-text-light)]"})))),e.createElement("footer",{className:"flex space-x-3 pt-6 lg:pt-8 mt-6 lg:mt-8 border-t border-[var(--color-border)]"},e.createElement("button",{onClick:d,className:"flex-1 flex items-center justify-center space-x-2 py-3 px-4 bg-[var(--color-surface)] text-[var(--color-text)] rounded-full hover:bg-[var(--color-hover)] transition-colors text-sm lg:text-base"},e.createElement(z,{size:18}),e.createElement("span",null,"Clear Filters"))))},_=()=>{const b=j(),[l,m]=k();f.useEffect(()=>{const c={};for(const[i,a]of l.entries())c[i]=a;const g=y(c);let r=!1;const n=new URLSearchParams;Object.entries(g).forEach(([i,a])=>{c[i]!==a&&(r=!0),a&&a!=="all"&&a!==""&&n.set(i,a)}),r&&m(n,{replace:!0})},[l,m,b])},W=({setNoteMessage:b})=>{const[l,m]=k(),[c,g]=f.useState([]),[r,n]=f.useState([]),[i,a]=f.useState(!0),[d,t]=f.useState(!1);_();const x={category:l.get("category")||"all",gender:l.get("gender")||"all",minPrice:l.get("minPrice")||"",maxPrice:l.get("maxPrice")||"",search:l.get("search")||""},o=y(x),u=async s=>{try{a(!0);const p=await I(s);g(p.data||[]);const v=[...new Set(p.data?.map(h=>h.category)||[])];n(v)}catch(p){$(b,p?.response?.data?.message||"Failed to load products",!1)}finally{a(!1)}};f.useEffect(()=>{u(o)},[l]);const N=s=>{const p=y(s),v=new URLSearchParams;Object.entries(p).forEach(([h,E])=>{E&&E!=="all"&&E!==""&&v.set(h,E)}),m(v)},w=Object.values(o).some(s=>s&&s!=="all"&&s!=="");return e.createElement("main",{className:"min-h-screen relative"},e.createElement("section",{id:"products-section",className:"py-8 lg:py-16"},e.createElement("div",{className:"container mx-auto px-4"},e.createElement("header",{className:"flex justify-between items-center mb-6 lg:hidden"},e.createElement("h1",{className:"text-2xl font-bold text-[var(--color-text)]"},"Products"),e.createElement("button",{onClick:()=>t(!0),className:`flex items-center space-x-2 px-4 py-2 rounded-full border transition-all duration-200 text-sm font-medium
                        ${w?"bg-[var(--color-main)] text-[var(--color-white)] border-transparent":"bg-[var(--color-background)] text-[var(--color-text)] border-[var(--color-border)] hover:border-[var(--color-main)]"}`},e.createElement(L,{size:16}),e.createElement("span",null,"Filters"),w&&e.createElement("span",{className:"bg-[var(--color-background)] text-[var(--color-main)] text-xs font-bold px-2 py-1 rounded-full"},"Active"))),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-[280px_1fr] gap-8"},e.createElement("aside",{className:"hidden lg:block relative"},e.createElement("div",{className:"lg:sticky lg:top-8 lg:h-[calc(100vh-64px)] lg:overflow-y-auto"},e.createElement(P,{categories:r,onFilterChange:N,currentFilters:o}))),e.createElement("section",{className:"w-full"},e.createElement("header",{className:"flex items-center justify-between mb-8"},e.createElement("h2",{className:"text-2xl font-bold text-[var(--color-text)] hidden lg:block"},"Product Results"),e.createElement("div",{className:"text-sm text-[var(--color-text-light)]"},e.createElement("span",{className:"font-semibold text-[var(--color-text)]"},c?.length)," products found")),i?e.createElement(A,{size:"medium",text:"Loading products...",fullScreen:!1}):e.createElement("section",{className:"grid grid-cols-1 grid-cols-xm-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-6 sm:gap-8"},c?.map(s=>e.createElement("article",{key:s._id},e.createElement(q,{product:s})))),!i&&c?.length===0&&e.createElement("section",{className:"text-center py-20"},e.createElement(O,{size:64,className:"mx-auto text-[var(--color-secondary)] mb-4"}),e.createElement("h3",{className:"text-xl font-semibold text-[var(--color-text)] mb-2"},"No products found"),e.createElement("p",{className:"text-[var(--color-text-light)]"},"Try adjusting your filters or search terms.")))))),e.createElement("div",{className:`fixed inset-0 z-[99999] transform transition-transform duration-300 ease-in-out ${d?"translate-x-0":"-translate-x-full"}`},e.createElement("div",{className:"absolute inset-0 bg-[var(--color-black)]/50",onClick:()=>t(!1)}),e.createElement("div",{className:"relative w-3/4 h-full shadow-2xl overflow-y-auto bg-[var(--color-surface)]"},e.createElement(P,{categories:r,onFilterChange:N,currentFilters:o,onClose:()=>t(!1),isModal:!0}))))};export{W as default};
