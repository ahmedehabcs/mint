import{A as v,r as p,R as e,F as P,j as U}from"./index-Py7kvHa0.js";import{s as u}from"./toastHelper-Cmf0APRO.js";import{A as F}from"./AdminTable-Ce2ugUIH.js";const V=async(c={})=>(await v.get("/coupons",{params:c})).data,R=async c=>(await v.post("/coupons/create",c)).data,I=async(c,i)=>(await v.put(`/coupons/update/${c}`,i)).data,L=async c=>(await v.delete(`/coupons/delete/${c}`)).data,A=async c=>(await v.patch(`/coupons/toggle-status/${c}`)).data,q=({isOpen:c,onClose:i,onSuccess:b,coupon:l,setNoteMessage:x,isDashboardMode:E=!1})=>{const[d,m]=p.useState(!1),[t,n]=p.useState({couponCode:"",discountType:"PERCENT",discountValue:"",startDate:"",endDate:"",maxUsageLimit:"",includedCategories:"",excludedCategories:"",restrictedEmails:""});p.useEffect(()=>{n(l?{couponCode:l.couponCode||"",discountType:l.discountType||"PERCENT",discountValue:l.discountValue||"",startDate:l.startDate?new Date(l.startDate).toISOString().slice(0,16):"",endDate:l.endDate?new Date(l.endDate).toISOString().slice(0,16):"",maxUsageLimit:l.maxUsageLimit||"",includedCategories:l.includedCategories?l.includedCategories.join(", "):"",excludedCategories:l.excludedCategories?l.excludedCategories.join(", "):"",restrictedEmails:l.restrictedEmails?l.restrictedEmails.join(", "):""}:{couponCode:"",discountType:"PERCENT",discountValue:"",startDate:"",endDate:"",maxUsageLimit:"",includedCategories:"",excludedCategories:"",restrictedEmails:""})},[l,c]);const f=async r=>{r.preventDefault(),m(!0);try{if(!t.couponCode||!t.startDate||!t.endDate||!t.maxUsageLimit){u(x,"Please fill in all required fields",!1),m(!1);return}if(t.discountType==="PERCENT"&&(!t.discountValue||t.discountValue<1||t.discountValue>100)){u(x,"For percentage discount, value must be between 1-100",!1),m(!1);return}const a={...t,discountValue:t.discountType==="FREE_SHIPPING"?null:parseFloat(t.discountValue),maxUsageLimit:parseInt(t.maxUsageLimit),includedCategories:t.includedCategories?t.includedCategories.split(",").map(s=>s.trim()).filter(s=>s):[],excludedCategories:t.excludedCategories?t.excludedCategories.split(",").map(s=>s.trim()).filter(s=>s):[],restrictedEmails:t.restrictedEmails?t.restrictedEmails.split(",").map(s=>s.trim()).filter(s=>s):[]};l?(await I(l._id,a),u(x,"Coupon updated successfully",!0)):(await R(a),u(x,"Coupon created successfully",!0)),b()}catch(a){u(x,a?.response?.data?.message||`Failed to ${l?"update":"create"} coupon`,!1)}finally{m(!1)}};return c?E?e.createElement("div",{className:"bg-[var(--color-background)] rounded-2xl border border-[var(--color-border)] p-6"},e.createElement("form",{onSubmit:f,className:"space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"Coupon Code ",e.createElement("span",{className:"text-[var(--color-error)]"},"*")),e.createElement("input",{type:"text",value:t.couponCode,onChange:r=>n(a=>({...a,couponCode:r.target.value.toUpperCase()})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-input-bg)] text-[var(--color-text)]",placeholder:"SAVE10",required:!0}))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"Discount Type ",e.createElement("span",{className:"text-[var(--color-error)]"},"*")),e.createElement("select",{value:t.discountType,onChange:r=>n(a=>({...a,discountType:r.target.value,discountValue:r.target.value==="FREE_SHIPPING"?"":a.discountValue})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-background)] text-[var(--color-text)]",required:!0},e.createElement("option",{value:"PERCENT"},"Percentage Discount"),e.createElement("option",{value:"FREE_SHIPPING"},"Free Shipping"))),t.discountType==="PERCENT"&&e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"Discount Value (%) ",e.createElement("span",{className:"text-[var(--color-error)]"},"*")),e.createElement("input",{type:"number",min:"1",max:"100",value:t.discountValue,onChange:r=>n(a=>({...a,discountValue:r.target.value})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-input-bg)] text-[var(--color-text)]",placeholder:"10",required:!0}))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"Start Date ",e.createElement("span",{className:"text-[var(--color-error)]"},"*")),e.createElement("input",{type:"datetime-local",value:t.startDate,onChange:r=>n(a=>({...a,startDate:r.target.value})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-input-bg)] text-[var(--color-text)]",required:!0})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"End Date ",e.createElement("span",{className:"text-[var(--color-error)]"},"*")),e.createElement("input",{type:"datetime-local",value:t.endDate,onChange:r=>n(a=>({...a,endDate:r.target.value})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-input-bg)] text-[var(--color-text)]",required:!0}))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"Max Usage Limit ",e.createElement("span",{className:"text-[var(--color-error)]"},"*")),e.createElement("input",{type:"number",min:"1",value:t.maxUsageLimit,onChange:r=>n(a=>({...a,maxUsageLimit:r.target.value})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-input-bg)] text-[var(--color-text)]",placeholder:"100",required:!0})),t.discountType==="PERCENT"&&e.createElement(e.Fragment,null,e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"Included Categories (Optional)"),e.createElement("input",{type:"text",value:t.includedCategories,onChange:r=>n(a=>({...a,includedCategories:r.target.value})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-input-bg)] text-[var(--color-text)]",placeholder:"tshirts, pants, dresses (comma separated)"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"Excluded Categories (Optional)"),e.createElement("input",{type:"text",value:t.excludedCategories,onChange:r=>n(a=>({...a,excludedCategories:r.target.value})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-input-bg)] text-[var(--color-text)]",placeholder:"shoes, accessories (comma separated)"})))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"Restricted Emails (Optional)"),e.createElement("input",{type:"text",value:t.restrictedEmails,onChange:r=>n(a=>({...a,restrictedEmails:r.target.value})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-input-bg)] text-[var(--color-text)]",placeholder:"user1@example.com, user2@example.com (comma separated)"}),e.createElement("p",{className:"text-xs text-[var(--color-text-light)] mt-1"},"Leave empty to allow all users")),e.createElement("div",{className:"flex flex-col sm:flex-row items-center justify-end space-y-4 sm:space-y-0 sm:space-x-4 pt-6 border-t border-[var(--color-border)]"},e.createElement("button",{type:"button",onClick:i,className:"w-full sm:w-auto px-6 py-2 text-[var(--color-text-light)] hover:text-[var(--color-text)] hover:bg-[var(--color-hover)] rounded-lg transition-colors font-medium"},"Cancel"),e.createElement("button",{type:"submit",disabled:d,className:"w-full sm:w-auto px-6 py-2 bg-[var(--color-main)] text-[var(--color-background)] rounded-lg hover:bg-[var(--color-main-dark)] transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium"},d?"Saving...":l?"Update Coupon":"Create Coupon")))):e.createElement("div",{className:"fixed inset-0 bg-[var(--color-overlay)] backdrop-blur-sm flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-[var(--color-background)] rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto transform transition-transform duration-300 ease-out scale-100 opacity-100"},e.createElement("div",{className:"flex items-center justify-between p-6 border-b border-[var(--color-border)]"},e.createElement("h2",{className:"text-2xl font-bold text-[var(--color-text)]"},l?"Edit Coupon":"Create New Coupon"),e.createElement("button",{onClick:i,className:"p-2 rounded-lg text-[var(--color-text-light)] hover:text-[var(--color-text)] hover:bg-[var(--color-hover)] transition-colors"},e.createElement(P,{size:24}))),e.createElement("form",{onSubmit:f,className:"p-6 space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"Coupon Code ",e.createElement("span",{className:"text-[var(--color-error)]"},"*")),e.createElement("input",{type:"text",value:t.couponCode,onChange:r=>n(a=>({...a,couponCode:r.target.value.toUpperCase()})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-input-bg)] text-[var(--color-text)]",placeholder:"SAVE10",required:!0}))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"Discount Type ",e.createElement("span",{className:"text-[var(--color-error)]"},"*")),e.createElement("select",{value:t.discountType,onChange:r=>n(a=>({...a,discountType:r.target.value,discountValue:r.target.value==="FREE_SHIPPING"?"":a.discountValue})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-input-bg)] text-[var(--color-text)]",required:!0},e.createElement("option",{value:"PERCENT"},"Percentage Discount"),e.createElement("option",{value:"FREE_SHIPPING"},"Free Shipping"))),t.discountType==="PERCENT"&&e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"Discount Value (%) ",e.createElement("span",{className:"text-[var(--color-error)]"},"*")),e.createElement("input",{type:"number",min:"1",max:"100",value:t.discountValue,onChange:r=>n(a=>({...a,discountValue:r.target.value})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-input-bg)] text-[var(--color-text)]",placeholder:"10",required:!0}))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"Start Date ",e.createElement("span",{className:"text-[var(--color-error)]"},"*")),e.createElement("input",{type:"datetime-local",value:t.startDate,onChange:r=>n(a=>({...a,startDate:r.target.value})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-input-bg)] text-[var(--color-text)]",required:!0})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"End Date ",e.createElement("span",{className:"text-[var(--color-error)]"},"*")),e.createElement("input",{type:"datetime-local",value:t.endDate,onChange:r=>n(a=>({...a,endDate:r.target.value})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-input-bg)] text-[var(--color-text)]",required:!0}))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"Max Usage Limit ",e.createElement("span",{className:"text-[var(--color-error)]"},"*")),e.createElement("input",{type:"number",min:"1",value:t.maxUsageLimit,onChange:r=>n(a=>({...a,maxUsageLimit:r.target.value})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-input-bg)] text-[var(--color-text)]",placeholder:"100",required:!0})),t.discountType==="PERCENT"&&e.createElement(e.Fragment,null,e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"Included Categories (Optional)"),e.createElement("input",{type:"text",value:t.includedCategories,onChange:r=>n(a=>({...a,includedCategories:r.target.value})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-input-bg)] text-[var(--color-text)]",placeholder:"tshirts, pants, dresses (comma separated)"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"Excluded Categories (Optional)"),e.createElement("input",{type:"text",value:t.excludedCategories,onChange:r=>n(a=>({...a,excludedCategories:r.target.value})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-input-bg)] text-[var(--color-text)]",placeholder:"shoes, accessories (comma separated)"})))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2"},"Restricted Emails (Optional)"),e.createElement("input",{type:"text",value:t.restrictedEmails,onChange:r=>n(a=>({...a,restrictedEmails:r.target.value})),className:"w-full px-4 py-2.5 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-main)] bg-[var(--color-input-bg)] text-[var(--color-text)]",placeholder:"user1@example.com, user2@example.com (comma separated)"}),e.createElement("p",{className:"text-xs text-[var(--color-text-light)] mt-1"},"Leave empty to allow all users")),e.createElement("div",{className:"flex flex-col sm:flex-row items-center justify-end space-y-4 sm:space-y-0 sm:space-x-4 pt-6 border-t border-[var(--color-border)]"},e.createElement("button",{type:"button",onClick:i,className:"w-full sm:w-auto px-6 py-2 text-[var(--color-text-light)] hover:text-[var(--color-text)] hover:bg-[var(--color-hover)] rounded-lg transition-colors font-medium"},"Cancel"),e.createElement("button",{type:"submit",disabled:d,className:"w-full sm:w-auto px-6 py-2 bg-[var(--color-main)] text-[var(--color-white)] rounded-lg hover:bg-[var(--color-main-dark)] transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium"},d?"Saving...":l?"Update Coupon":"Create Coupon"))))):null},H=({setNoteMessage:c})=>{const[i,b]=p.useState([]),[l,x]=p.useState(!0),[E,d]=p.useState(!1),[m,t]=p.useState(null),[n,f]=p.useState("all");p.useEffect(()=>{r()},[n]);const r=async()=>{try{x(!0);const o=await V({status:n});b(o.data)}catch{u(c,"Failed to load coupons",!1)}finally{x(!1)}},a=()=>{t(null),d(!0)},s=o=>{t(o),d(!1)},y=async o=>{if(window.confirm("Are you sure you want to delete this coupon?"))try{await L(o),u(c,"Coupon deleted successfully",!0),r()}catch(g){u(c,g?.response?.data?.message||"Failed to delete coupon",!1)}},h=async o=>{try{await A(o),u(c,"Coupon status updated successfully",!0),r()}catch(g){u(c,g?.response?.data?.message||"Failed to update coupon status",!1)}},C=()=>{d(!1),t(null)},N=()=>{d(!1),t(null),r()},w=o=>{const g=new Date,k=g>new Date(o.endDate),S=o.currentUsage>=o.maxUsageLimit,T=g<new Date(o.startDate);return o.isActive?k?e.createElement("span",{className:"px-3 py-1 bg-[var(--color-pink-dark)]/20 text-[var(--color-pink-dark)] rounded-full text-xs font-medium cursor-pointer hover:bg-[var(--color-pink-dark)]/80 transition-colors"},"Expired"):S?e.createElement("span",{className:"px-3 py-1 bg-[var(--color-warning)]/20 text-[var(--color-warning)] rounded-full text-xs font-medium cursor-pointer hover:bg-[var(--color-warning)]/80 transition-colors"},"Exhausted"):T?e.createElement("span",{className:"px-3 py-1 bg-[var(--color-waiting)]/20 text-[var(--color-waiting)] rounded-full text-xs font-medium cursor-pointer hover:bg-[var(--color-waiting-bg)]/80 transition-colors"},"Not Started"):e.createElement("span",{className:"px-3 py-1 bg-[var(--color-success)]/20 text-[var(--color-success)] rounded-full text-xs font-medium cursor-pointer hover:bg-[var(--color-success)]/80 transition-colors"},"Active"):e.createElement("span",{className:"px-3 py-1 bg-[var(--color-canceled)]/20 text-[var(--color-canceled)] rounded-full text-xs font-medium cursor-pointer hover:bg-[var(--color-canceled)]/80 transition-colors"},"Inactive")},D=o=>o.discountType==="PERCENT"?`${o.discountValue}% OFF`:"FREE SHIPPING";return E||m?e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h2",{className:"text-2xl font-bold text-[var(--color-text)]"},m?"Edit Coupon":"Create New Coupon"),e.createElement("p",{className:"text-[var(--color-text-light)]"},m?"Update coupon details":"Add a new discount coupon")),e.createElement("button",{onClick:C,className:"flex items-center gap-2 px-4 py-2 bg-[var(--color-main)] text-[var(--color-text)] rounded-lg hover:bg-[var(--color-hover)] transition-colors"},"Back to Coupons")),e.createElement(q,{isOpen:!0,onClose:C,onSuccess:N,coupon:m,setNoteMessage:c,isDashboardMode:!0})):e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4"},e.createElement("div",null,e.createElement("h2",{className:"text-2xl font-bold text-[var(--color-text)]"},"Coupons"),e.createElement("p",{className:"text-[var(--color-text-light)]"},"Manage discount coupons and promotions")),e.createElement("button",{onClick:a,className:"flex items-center space-x-2 px-4 py-2 bg-[var(--color-main)] text-white rounded-lg hover:bg-[var(--color-main)]/90 transition-colors"},e.createElement(U,{size:20}),e.createElement("span",null,"Create Coupon"))),e.createElement("div",{className:"flex flex-wrap gap-1 sm:gap-2"},[{value:"all",label:"All Coupons"},{value:"active",label:"Active"},{value:"expired",label:"Expired"},{value:"usage_exhausted",label:"Exhausted"},{value:"inactive",label:"Inactive"}].map(o=>e.createElement("button",{key:o.value,onClick:()=>f(o.value),className:`px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm transition-colors whitespace-nowrap ${n===o.value?"bg-[var(--color-main)] text-[var(--color-white)]":"bg-[var(--color-surface)] text-[var(--color-text)] hover:bg-[var(--color-hover)]"}`},o.label))),e.createElement(F,{title:"",description:"",data:i,loading:l,showRefresh:!1,columns:[{header:"Coupon Code",key:"couponCode",width:"150px",render:o=>e.createElement("div",{className:"text-sm font-medium text-[var(--color-text)] font-mono"},o.couponCode)},{header:"Discount",key:"discountType",width:"100px",className:"hidden sm:table-cell",cellClassName:"hidden sm:table-cell",render:o=>e.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-[var(--color-accent)]/10 text-[var(--color-accent)]"},D(o))},{header:"Usage",key:"currentUsage",width:"100px",render:o=>e.createElement("span",{className:"text-sm text-[var(--color-text)]"},o.currentUsage," / ",o.maxUsageLimit)},{header:"Valid Until",key:"endDate",width:"100px",className:"hidden sm:table-cell",cellClassName:"hidden sm:table-cell",render:o=>e.createElement("span",{className:"text-sm text-[var(--color-text)]"},new Date(o.endDate).toLocaleDateString())},{header:"Status",key:"isActive",width:"120px",render:o=>e.createElement("div",{onClick:()=>h(o._id)},w(o))}],onEdit:s,onDelete:y,emptyMessage:"No coupons found",showActions:!0}))};export{H as default};
